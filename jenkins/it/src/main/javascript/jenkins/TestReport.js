define(function (require) {
	"use strict";
	var _ = require("underscore");
	var TboneModel = require("common/TboneModel");

	/**
	 * The test output generated by a specific build.
	 *
	 * @class TestReport
	 */
	return TboneModel.extend({
		defaults: {
			failCount: null,
			passCount: null,
			build: null
		},

		url: function () {
			return "/job/" + this.get("build.job.name") + "/" + this.get("build.number") + "/testReport/api/json";
		},

		/**
		 * Get a list of the test cases that failed.
		 * @returns {Object[]}
		 */
		getFailedCases: function () {
			var failedCases = [];
			_.each(this.get("suites"), function (suite) {
				_.each(suite.cases, function (kase) {
					if (kase.status === "FAILED") {
						failedCases.push(kase);
					}
				});
			});
			return failedCases;
		}
	});
});
